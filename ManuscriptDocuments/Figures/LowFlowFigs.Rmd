---
title: "Low Flow Figures"
output:
  html_document:
    df_print: paged
---
Load packages
```{r packages, message=FALSE, echo=FALSE, warning=FALSE}
library(lubridate)
library(ggplot2)
library(zoo)
library(plotly)
library(ggpubr)
library(ggthemes)
library(tidyverse)
```

Figure 1: Conceptual model

Figure 2: Site map

Figure 3: Hydro and climate data
```{r Figure3-HydroAndClim}

```


Figure 4: WS1 surplus and deficit 
```{r}

```

Figure 5: Soil moisture/Riparian water table

Figure 6: Window analysis

Figure 7: Transpiration deficit
```{r Figure7-TransDefFig}
#Load Data
load("TransDef.RData")

#Set colors
youngCol = "#4dac26"
oldCol = "#a6611a"
ripDefCol = "#01665e"
hillDefCol = "#80cdc1"

myCols = c(c("Young" = youngCol, "Old" = oldCol, "HillDef" = hillDefCol, "RipDef" = ripDefCol))

myLineWidth = 2
myTxtSz = 20

#Hillslope Transpiration Deficit
HillslopeTransDefPlot <- TransDef %>% 
  select(DATE, transHillOld, transHillYoung, transDefHill) %>% 
  ggplot() +
  geom_area(aes(x = DATE, y = transHillYoung, fill = "Young"), 
            alpha = 0.3) + 
  geom_area(aes(x = DATE, y = transHillOld, fill = "Old"), 
            alpha = 0.3) +
  geom_area(aes(x = DATE, y = transDefHill, fill = "HillDef"), 
            alpha = 0.7) +
  theme_bw(base_size = myTxtSz) +
  scale_x_date(expand = c(0,0)) +
  labs(x = "", y = "Transpiration (mm/d)") +
  scale_fill_manual(name = "", values = myCols)
print(HillslopeTransDefPlot)

#Riparian Transpiration Deficit
RiparianTransDefPlot <- TransDef %>% 
  select(DATE, transRipOld, transRipYoung, transDefRip) %>% 
  ggplot() +
  geom_area(aes(x = DATE, y = transRipYoung, fill = "Young"), 
            alpha = 0.3) + 
  geom_area(aes(x = DATE, y = transRipOld, fill = "Old"), 
            alpha = 0.3) +
  geom_area(aes(x = DATE, y = transDefRip, fill = "RipDef"),
            alpha = 0.7) +
  theme_bw(base_size = myTxtSz) +
  scale_x_date(expand = c(0,0)) +
  labs(x = "", y = "Transpiration (mm/d)") +
  scale_fill_manual(name = "", values = myCols)
print(RiparianTransDefPlot)

#Overall Transpiration Deficit
myCols = c(Rip = ripDefCol, Hill = hillDefCol)

OverallTransDefPlot <- TransDef %>% 
  select(DATE, transDefRip, transDefHill) %>% 
  mutate(Rip = cumsum(transDefRip),
         Hill = cumsum(transDefHill)) %>% 
  select(-c(transDefRip, transDefHill)) %>% 
  gather(Position, sumTrans, Rip, Hill) %>% 
  ggplot(aes(x = DATE, y = sumTrans, fill = Position)) +
  geom_area(alpha = 0.7) +
  scale_fill_manual(name = "", values = myCols) +
   theme_bw(base_size = myTxtSz) +
  scale_x_date(expand = c(0,0)) +
  labs(x = "", y = "\u03A3 Transpiration (mm)")
print(OverallTransDefPlot)  

```

Figure 8: Conceptual model revisited

Table 1: Transpiration values
